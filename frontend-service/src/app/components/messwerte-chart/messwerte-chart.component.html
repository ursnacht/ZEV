<div class="container">
  <h1>Messwerte Grafik</h1>

  <div *ngIf="message" class="message" [ngClass]="messageType">
    {{ message }}
  </div>

  <form (ngSubmit)="onSubmit()">
    <div class="form-group">
      <label>Einheiten:</label>
      <div class="checkbox-group">
        <div *ngFor="let einheit of einheiten" class="checkbox-item">
          <input
            type="checkbox"
            [id]="'einheit-' + einheit.id"
            [value]="einheit.id"
            [checked]="selectedEinheitIds.has(einheit.id!)"
            (change)="onEinheitToggle(einheit.id!)"
          >
          <label [for]="'einheit-' + einheit.id">
            {{ einheit.name }} ({{ einheit.typ }})
          </label>
        </div>
      </div>
    </div>

    <div class="form-group">
      <label for="dateFrom">Von Datum:</label>
      <input type="date" id="dateFrom" name="dateFrom" [(ngModel)]="dateFrom" (ngModelChange)="onDateFromChange()" required>
    </div>

    <div class="form-group">
      <label for="dateTo">Bis Datum:</label>
      <input type="date" id="dateTo" name="dateTo" [(ngModel)]="dateTo" required>
    </div>

    <button type="submit" class="primary" [disabled]="loading || !dateFrom || !dateTo || selectedEinheitIds.size === 0">
      {{ loading ? 'Lade Daten...' : 'Anzeigen' }}
    </button>
  </form>

  <div *ngFor="let chartData of charts" class="chart-wrapper">
    <h3>{{ chartData.einheitName }} ({{ chartData.einheitTyp }})</h3>
    <div class="chart-container">
      <canvas [id]="'chart-' + chartData.einheitId"></canvas>
    </div>
  </div>
</div>
